78fa5ae14cbc2b45e952a3230ae925ab
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const app_controller_1 = require("./app.controller");
const app_service_1 = require("./app.service");
const supplier_entity_1 = require("./supplier.entity");
const UpdateSupplierDTO_1 = require("./dto/UpdateSupplierDTO");
describe('AppController', () => {
    let appController;
    let appService;
    beforeEach(async () => {
        const app = await testing_1.Test.createTestingModule({
            controllers: [app_controller_1.AppController],
            providers: [
                {
                    provide: app_service_1.AppService,
                    useValue: {
                        createSupplier: jest.fn(),
                        updateLastLogin: jest.fn(),
                        getSupplier: jest.fn(),
                        findSupplierByUsername: jest.fn(),
                        getAllSuppliers: jest.fn(),
                        searchAllSuppliers: jest.fn(),
                        updateSupplier: jest.fn(),
                        deleteSupplier: jest.fn(),
                    },
                },
            ],
        }).compile();
        appController = app.get(app_controller_1.AppController);
        appService = app.get(app_service_1.AppService);
    });
    describe('createSupplier', () => {
        it('should create a supplier', async () => {
            const createSupplierDto = {
                username: 'testuser',
                password: 'testpassword',
                email: 'test@example.com',
                contactNo: '123456789',
                role: 'supplier',
                address: '123 Test Street',
                nic: '123456789V',
                paymentMethod: 'credit card',
                paymentDetails: '1234-5678-9012-3456',
                profilePicture: 'profile.jpg',
            };
            const result = new supplier_entity_1.Supplier();
            jest.spyOn(appService, 'createSupplier').mockResolvedValue(result);
            expect(await appController.createSupplier(createSupplierDto)).toBe(result);
        });
    });
    describe('updateLastLogin', () => {
        it('should update the last login', async () => {
            const data = { id: 1, lastLogin: new Date() };
            const result = new supplier_entity_1.Supplier();
            jest.spyOn(appService, 'updateLastLogin').mockResolvedValue(result);
            expect(await appController.updateLastLogin(data)).toBe(result);
        });
    });
    describe('getSupplierById', () => {
        it('should return a supplier by id', async () => {
            const id = 1;
            const result = new supplier_entity_1.Supplier();
            jest.spyOn(appService, 'getSupplier').mockResolvedValue(result);
            expect(await appController.getSupplierById(id)).toBe(result);
        });
    });
    describe('getSupplierByUsername', () => {
        it('should return a supplier by username', async () => {
            const username = 'testuser';
            const result = new supplier_entity_1.Supplier();
            jest.spyOn(appService, 'findSupplierByUsername').mockResolvedValue(result);
            expect(await appController.getSupplierByUsername(username)).toBe(result);
        });
    });
    describe('getAllSuppliers', () => {
        it('should return all suppliers', async () => {
            const result = [new supplier_entity_1.Supplier()];
            jest.spyOn(appService, 'getAllSuppliers').mockResolvedValue(result);
            expect(await appController.getAllSuppliers()).toBe(result);
        });
    });
    describe('searchAllSuppliers', () => {
        it('should search all suppliers', async () => {
            const query = {};
            const result = [new supplier_entity_1.Supplier()];
            jest.spyOn(appService, 'searchAllSuppliers').mockResolvedValue(result);
            expect(await appController.searchAllSuppliers(query)).toBe(result);
        });
    });
    describe('updateSupplier', () => {
        it('should update a supplier', async () => {
            const data = { id: 1, updateSupplierDto: new UpdateSupplierDTO_1.UpdateSupplierDTO() };
            const result = new supplier_entity_1.Supplier();
            jest.spyOn(appService, 'updateSupplier').mockResolvedValue(result);
            expect(await appController.updateSupplier(data)).toBe(result);
        });
    });
    describe('deleteSupplier', () => {
        it('should delete a supplier', async () => {
            const id = 1;
            const result = 'Successfully Deleted';
            jest.spyOn(appService, 'deleteSupplier').mockResolvedValue(result);
            expect(await appController.deleteSupplier(id)).toBe(result);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxkaW51a1xcRGVza3RvcFxcTXkgRG9jc1xcUHJvamVjdHNcXFRyYWRlYXN5XFxUcmFkZWFzeS1CYWNrZW5kXFxzdXBwbGllcl9tYW5hZ2VtZW50XFxzcmNcXGFwcC5jb250cm9sbGVyLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBc0Q7QUFDdEQscURBQWlEO0FBQ2pELCtDQUEyQztBQUMzQyx1REFBNkM7QUFFN0MsK0RBQTREO0FBRTVELFFBQVEsQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFO0lBQzdCLElBQUksYUFBNEIsQ0FBQztJQUNqQyxJQUFJLFVBQXNCLENBQUM7SUFFM0IsVUFBVSxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ3BCLE1BQU0sR0FBRyxHQUFrQixNQUFNLGNBQUksQ0FBQyxtQkFBbUIsQ0FBQztZQUN4RCxXQUFXLEVBQUUsQ0FBQyw4QkFBYSxDQUFDO1lBQzVCLFNBQVMsRUFBRTtnQkFDVDtvQkFDRSxPQUFPLEVBQUUsd0JBQVU7b0JBQ25CLFFBQVEsRUFBRTt3QkFDUixjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTt3QkFDekIsZUFBZSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7d0JBQzFCLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO3dCQUN0QixzQkFBc0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO3dCQUNqQyxlQUFlLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTt3QkFDMUIsa0JBQWtCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTt3QkFDN0IsY0FBYyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7d0JBQ3pCLGNBQWMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO3FCQUMxQjtpQkFDRjthQUNGO1NBQ0YsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBRWIsYUFBYSxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQWdCLDhCQUFhLENBQUMsQ0FBQztRQUN0RCxVQUFVLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBYSx3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Z0JBQWdCLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUVuRSxNQUFNLENBQUMsTUFBTSxhQUFhLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ2hFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO1FBQzlCLEVBQUUsQ0FBQywwQkFBMEIsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN4QyxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUM7WUFDYixNQUFNLE1BQU0sR0FBRyxzQkFBc0IsQ0FBQztZQUN0QyxJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRW5FLE1BQU0sQ0FBQyxNQUFNLGFBQWEsQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZGludWtcXERlc2t0b3BcXE15IERvY3NcXFByb2plY3RzXFxUcmFkZWFzeVxcVHJhZGVhc3ktQmFja2VuZFxcc3VwcGxpZXJfbWFuYWdlbWVudFxcc3JjXFxhcHAuY29udHJvbGxlci5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xyXG5pbXBvcnQgeyBBcHBDb250cm9sbGVyIH0gZnJvbSAnLi9hcHAuY29udHJvbGxlcic7XHJcbmltcG9ydCB7IEFwcFNlcnZpY2UgfSBmcm9tICcuL2FwcC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgU3VwcGxpZXIgfSBmcm9tICcuL3N1cHBsaWVyLmVudGl0eSc7XHJcbmltcG9ydCB7IFN1cHBsaWVyRFRPIH0gZnJvbSAnLi9kdG8vU3VwcGxpZXJEVE8nO1xyXG5pbXBvcnQgeyBVcGRhdGVTdXBwbGllckRUTyB9IGZyb20gJy4vZHRvL1VwZGF0ZVN1cHBsaWVyRFRPJztcclxuXHJcbmRlc2NyaWJlKCdBcHBDb250cm9sbGVyJywgKCkgPT4ge1xyXG4gIGxldCBhcHBDb250cm9sbGVyOiBBcHBDb250cm9sbGVyO1xyXG4gIGxldCBhcHBTZXJ2aWNlOiBBcHBTZXJ2aWNlO1xyXG5cclxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IGFwcDogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XHJcbiAgICAgIGNvbnRyb2xsZXJzOiBbQXBwQ29udHJvbGxlcl0sXHJcbiAgICAgIHByb3ZpZGVyczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHByb3ZpZGU6IEFwcFNlcnZpY2UsXHJcbiAgICAgICAgICB1c2VWYWx1ZToge1xyXG4gICAgICAgICAgICBjcmVhdGVTdXBwbGllcjogamVzdC5mbigpLFxyXG4gICAgICAgICAgICB1cGRhdGVMYXN0TG9naW46IGplc3QuZm4oKSxcclxuICAgICAgICAgICAgZ2V0U3VwcGxpZXI6IGplc3QuZm4oKSxcclxuICAgICAgICAgICAgZmluZFN1cHBsaWVyQnlVc2VybmFtZTogamVzdC5mbigpLFxyXG4gICAgICAgICAgICBnZXRBbGxTdXBwbGllcnM6IGplc3QuZm4oKSxcclxuICAgICAgICAgICAgc2VhcmNoQWxsU3VwcGxpZXJzOiBqZXN0LmZuKCksXHJcbiAgICAgICAgICAgIHVwZGF0ZVN1cHBsaWVyOiBqZXN0LmZuKCksXHJcbiAgICAgICAgICAgIGRlbGV0ZVN1cHBsaWVyOiBqZXN0LmZuKCksXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF0sXHJcbiAgICB9KS5jb21waWxlKCk7XHJcblxyXG4gICAgYXBwQ29udHJvbGxlciA9IGFwcC5nZXQ8QXBwQ29udHJvbGxlcj4oQXBwQ29udHJvbGxlcik7XHJcbiAgICBhcHBTZXJ2aWNlID0gYXBwLmdldDxBcHBTZXJ2aWNlPihBcHBTZXJ2aWNlKTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ2NyZWF0ZVN1cHBsaWVyJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSBzdXBwbGllcicsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgY3JlYXRlU3VwcGxpZXJEdG86IFN1cHBsaWVyRFRPID0ge1xyXG4gICAgICAgIHVzZXJuYW1lOiAndGVzdHVzZXInLFxyXG4gICAgICAgIHBhc3N3b3JkOiAndGVzdHBhc3N3b3JkJyxcclxuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxyXG4gICAgICAgIGNvbnRhY3RObzogJzEyMzQ1Njc4OScsXHJcbiAgICAgICAgcm9sZTogJ3N1cHBsaWVyJyxcclxuICAgICAgICBhZGRyZXNzOiAnMTIzIFRlc3QgU3RyZWV0JyxcclxuICAgICAgICBuaWM6ICcxMjM0NTY3ODlWJyxcclxuICAgICAgICBwYXltZW50TWV0aG9kOiAnY3JlZGl0IGNhcmQnLFxyXG4gICAgICAgIHBheW1lbnREZXRhaWxzOiAnMTIzNC01Njc4LTkwMTItMzQ1NicsXHJcbiAgICAgICAgcHJvZmlsZVBpY3R1cmU6ICdwcm9maWxlLmpwZycsXHJcbiAgICAgIH07XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBTdXBwbGllcigpO1xyXG4gICAgICBqZXN0LnNweU9uKGFwcFNlcnZpY2UsICdjcmVhdGVTdXBwbGllcicpLm1vY2tSZXNvbHZlZFZhbHVlKHJlc3VsdCk7XHJcblxyXG4gICAgICBleHBlY3QoYXdhaXQgYXBwQ29udHJvbGxlci5jcmVhdGVTdXBwbGllcihjcmVhdGVTdXBwbGllckR0bykpLnRvQmUocmVzdWx0KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgndXBkYXRlTGFzdExvZ2luJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgdGhlIGxhc3QgbG9naW4nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSB7IGlkOiAxLCBsYXN0TG9naW46IG5ldyBEYXRlKCkgfTtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFN1cHBsaWVyKCk7XHJcbiAgICAgIGplc3Quc3B5T24oYXBwU2VydmljZSwgJ3VwZGF0ZUxhc3RMb2dpbicpLm1vY2tSZXNvbHZlZFZhbHVlKHJlc3VsdCk7XHJcblxyXG4gICAgICBleHBlY3QoYXdhaXQgYXBwQ29udHJvbGxlci51cGRhdGVMYXN0TG9naW4oZGF0YSkpLnRvQmUocmVzdWx0KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnZ2V0U3VwcGxpZXJCeUlkJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYSBzdXBwbGllciBieSBpZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgaWQgPSAxO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBuZXcgU3VwcGxpZXIoKTtcclxuICAgICAgamVzdC5zcHlPbihhcHBTZXJ2aWNlLCAnZ2V0U3VwcGxpZXInKS5tb2NrUmVzb2x2ZWRWYWx1ZShyZXN1bHQpO1xyXG5cclxuICAgICAgZXhwZWN0KGF3YWl0IGFwcENvbnRyb2xsZXIuZ2V0U3VwcGxpZXJCeUlkKGlkKSkudG9CZShyZXN1bHQpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdnZXRTdXBwbGllckJ5VXNlcm5hbWUnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBhIHN1cHBsaWVyIGJ5IHVzZXJuYW1lJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCB1c2VybmFtZSA9ICd0ZXN0dXNlcic7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBTdXBwbGllcigpO1xyXG4gICAgICBqZXN0LnNweU9uKGFwcFNlcnZpY2UsICdmaW5kU3VwcGxpZXJCeVVzZXJuYW1lJykubW9ja1Jlc29sdmVkVmFsdWUocmVzdWx0KTtcclxuXHJcbiAgICAgIGV4cGVjdChhd2FpdCBhcHBDb250cm9sbGVyLmdldFN1cHBsaWVyQnlVc2VybmFtZSh1c2VybmFtZSkpLnRvQmUocmVzdWx0KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnZ2V0QWxsU3VwcGxpZXJzJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYWxsIHN1cHBsaWVycycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gW25ldyBTdXBwbGllcigpXTtcclxuICAgICAgamVzdC5zcHlPbihhcHBTZXJ2aWNlLCAnZ2V0QWxsU3VwcGxpZXJzJykubW9ja1Jlc29sdmVkVmFsdWUocmVzdWx0KTtcclxuXHJcbiAgICAgIGV4cGVjdChhd2FpdCBhcHBDb250cm9sbGVyLmdldEFsbFN1cHBsaWVycygpKS50b0JlKHJlc3VsdCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ3NlYXJjaEFsbFN1cHBsaWVycycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgc2VhcmNoIGFsbCBzdXBwbGllcnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHF1ZXJ5ID0ge307XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IFtuZXcgU3VwcGxpZXIoKV07XHJcbiAgICAgIGplc3Quc3B5T24oYXBwU2VydmljZSwgJ3NlYXJjaEFsbFN1cHBsaWVycycpLm1vY2tSZXNvbHZlZFZhbHVlKHJlc3VsdCk7XHJcblxyXG4gICAgICBleHBlY3QoYXdhaXQgYXBwQ29udHJvbGxlci5zZWFyY2hBbGxTdXBwbGllcnMocXVlcnkpKS50b0JlKHJlc3VsdCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ3VwZGF0ZVN1cHBsaWVyJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgYSBzdXBwbGllcicsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZGF0YSA9IHsgaWQ6IDEsIHVwZGF0ZVN1cHBsaWVyRHRvOiBuZXcgVXBkYXRlU3VwcGxpZXJEVE8oKSB9O1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBuZXcgU3VwcGxpZXIoKTtcclxuICAgICAgamVzdC5zcHlPbihhcHBTZXJ2aWNlLCAndXBkYXRlU3VwcGxpZXInKS5tb2NrUmVzb2x2ZWRWYWx1ZShyZXN1bHQpO1xyXG5cclxuICAgICAgZXhwZWN0KGF3YWl0IGFwcENvbnRyb2xsZXIudXBkYXRlU3VwcGxpZXIoZGF0YSkpLnRvQmUocmVzdWx0KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnZGVsZXRlU3VwcGxpZXInLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIGRlbGV0ZSBhIHN1cHBsaWVyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBpZCA9IDE7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9ICdTdWNjZXNzZnVsbHkgRGVsZXRlZCc7XHJcbiAgICAgIGplc3Quc3B5T24oYXBwU2VydmljZSwgJ2RlbGV0ZVN1cHBsaWVyJykubW9ja1Jlc29sdmVkVmFsdWUocmVzdWx0KTtcclxuXHJcbiAgICAgIGV4cGVjdChhd2FpdCBhcHBDb250cm9sbGVyLmRlbGV0ZVN1cHBsaWVyKGlkKSkudG9CZShyZXN1bHQpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwidmVyc2lvbiI6M30=